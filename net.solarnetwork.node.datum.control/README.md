# SolarNode Control Event Datum Logger

This SolarNode plugin provides a component that can generate a datum stream from SolarNode control
values.

![Control Datum Source settings](docs/solarnode-datum-control-settings.png)

The datum generated by this component will use the control's ID value for the datum source ID. For
the control value, if the control defines a specific property name the generated datum will have a
status property with the same name. Otherwise the generated datum will have a status property `val`,
and if the control has a number value an instantaneous property `v` will also be created.

> :warning: **Note** that if a control returns a control value that is _also_ already a datum
> instance, that datum will be used directly. Thus the actual property names used could be
> different.

# Install

The plugin can be installed via the **Plugins** page on your SolarNode. It appears under the
**Datum** category as **Control Datum Source**. Once installed, a **Control Datum Source**
component will become available.

# Configuration

Each service configuration contains the following settings:

| Setting               | Description  |
|:----------------------|:-------------|
| Service Name          | A unique name to identify this data source with.                                 |
| Service Group         | A group name to associate this data source with.                                 |
| Control ID            | A regular expression to filter control ID values by, or left blank to generate datum for all control IDs. |
| Event Mode            | The [Event Mode](#event-mode) to use. |
| Persist Mode          | The [Persist Mode](#persist-mode) to use. |

## Event Mode

The **Event Mode** setting allows you to configure which control events are turned into datum
objects. This can be useful for controls that publish events outside of being polled explicitly.

| Mode | Description |
|:-----|:------------|
| Polled Only | Datum are generated only via the **Schedule** setting on this component. |
| Sampled     | Emitted when some plugin reads (samples) a control value. |
| Changed     | Emitted when a plugin writes (changes) a control value.   |
| Sampled and changed | Generate datum from both **Sampled** and **Changed** control events. |

## Persist Mode

The **Persist Mode** settings configures which datum are persisted in SolarNetwork.

| Mode | Description |
|:-----|:------------|
| Poll           | Persist only polled control values. Datum generated via events will not be persisted. |
| Poll and event | Persist polled and event-based datum. |
